<nb-card>
  <nb-card-header>
    <div class="row">
      <div class="col-10">

        <h5>Tasks</h5>

      </div>
      <div class="col text-right">
        <select class="form-control" name="task_type" [(ngModel)]="task_type">
          <option value="1">Normal Task</option>
          <option value="2">Scheduled Task</option>

        </select>
      </div>

    </div>


  </nb-card-header>
  <nb-card>
    <nb-card-body>

      <!-- Normal Task Form      -->

      <div *ngIf="task_type == 1">
        <div class="container">
          <div class="row ">
            <div class="col-3">
              <div class="form-group">
                <label>User</label>
              <auto-suggestion (onSelected)="selectedNormalUser($event)" url="Admin/searchAdmin.json" [display]="['name']"
                seperator="-" placeholder="Search User" autocomplete="off" inputId="id" [preSelected]='{name: normalTask.userName}'>
              </auto-suggestion>
              </div>
            </div>
            <div class="col-3">                
                  <div class="form-group">
                    <label>Last Date</label>
                    <uj-date-time-picker [mind]="normalTask.date" [isStart]="true"  [isTime]="false" (onChanged)="normalTask.date=$event" [dateTimeValue]="normalTask.date" > </uj-date-time-picker>
                  </div>
            </div>
            <div class="col-3">
                <div class="form-group">
                  <label>Task</label>
                  <textarea row="2" cols="15" placeholder="Enter Task" name="nomaltask" class="form-control" [(ngModel)]="normalTask.task"
                    class="form-control"></textarea>
                </div>
            </div>
            <div class="col-3">
              <div class="form-group" style="display: flex;
              align-items: center;
              justify-content: center;">
                <input type="checkbox" [checked]="normalTask.isUrgent" (change)="normalTask.isUrgent = !normalTask.isUrgent"/>
              <label style="margin-left: 5px;;"><strong>Urgent</strong></label>
              </div>
            </div>
          </div>
          <div class="row mt-1">
            <div class="col-12 text-right">
              <button class="btn btn-primary text-capitalize" id="button" (click)="saveUser('normalTask')">Save</button>
            </div>
          </div>
        </div>

      </div>

      <!-- Schedule task Form -->

      <div *ngIf="task_type == 2">

      <div class="container">
        <div class="row ">
          <div class="col-4">
            <div class="form-group">
              <label>Description</label>
              <input style="width: 100%;" type="description" placeholder="Description" class="form-control" [(ngModel)]="scheduledTask.description">
            </div>
          </div>
          <div class="col-4">                
                <div class="form-group">
                  <label>Primary User</label>
            <auto-suggestion (onSelected)="selectedPrimarUser($event)" url="Admin/searchAdmin.json" [display]="['name']"
              seperator="-" placeholder="Primary User" autocomplete="off" inputId="id" [preSelected]='{name: scheduledTask.primaryUser}'>
            </auto-suggestion>
                </div>
          </div>
          <div class="col-4">
              <div class="form-group">
                <label>Escalation User</label>
                <auto-suggestion (onSelected)="selectedEscalationUser($event)" url="Admin/searchAdmin.json" [display]="['name']"
                  seperator="-" placeholder="Escalation User" autocomplete="off" inputId="id" [preSelected]='{name: scheduledTask.escalationUser}'> 
                </auto-suggestion>
              </div>
          </div>
          <div class="col-4">
            <div class="form-group">
              <label>Reporting User</label>
              <auto-suggestion (onSelected)="selectedReportingUser($event)" url="Admin/searchAdmin.json"
                [display]="['name']" seperator="-" placeholder="Reporting User" autocomplete="off" inputId="id" [preSelected]='{name: scheduledTask.reportingUser}'>
              </auto-suggestion>
            </div>
        </div>
        <div class="col-4">
          <div class="form-group">
            <label>Logic Type</label>
            <input type="number" style="width: 100%;" placeholder="Logic Type" class="form-control" [(ngModel)]="scheduledTask.logicType">
          </div>
      </div>
      <div class="col-4">
        <div class="form-group">
          <label>Schedule Param</label>
          <input style="width: 100%;" type="number" placeholder="Schedule Params" class="form-control" [(ngModel)]="scheduledTask.scheduleParam">
        </div>
      </div>
      <div class="col-4">
        <div class="form-group">
          <label>Days</label>
          <input style="width: 100%;" type="number" placeholder="Days" class="form-control" [(ngModel)]="scheduledTask.days">
        </div>
      </div>
      <div class="col-4">
        <div class="form-group">
          <label>Hours</label>
          <input style="width: 100%;" type="number" placeholder="Hours" class="form-control" [(ngModel)]="scheduledTask.hours">
        </div>
      </div>
        </div>



        <div class="row mt-1">
          <div class="col-12 text-right">
            <button class="btn btn-primary text-capitalize" id="button" (click)="saveUser('scheduledTask')">Save</button>
          </div>
        </div>
      </div>

    </div>




      <!-- Tabs      -->

      <div class="tabs_style_main">
        <ul class="tabs_style text-left">
          <li [ngClass]="activeTab=='Normal Task'?'active':''" (click)="activeTab='Normal Task'; getNormalTask()">Normal
            Tasks
          </li>

          <li [ngClass]="activeTab=='Scheduled Task'?'active':''" (click)="activeTab='Scheduled Task'; getScheduledTask()">
            Scheduled Task
          </li>

        </ul>

      </div>
      
      <div *ngIf="activeTab=='Normal Task'">

        <table class="table table-border mt-1">
          <thead class="thead">
            <tr>
              <th>#</th>
              <!-- <th>Title</th> -->
              <th>Description</th>
              <!-- <th>Project</th>
              <th>Segment</th>
              <th>Assigner</th>
              <th>Start Time</th>
              <th>End Time</th>
              <th>Action</th> -->

            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let task of normalTaskList; let i=index;">
              <td>0{{i+1}}</td>
              <!-- <td>{{task.Title }}</td> -->
              <td>{{task.description }}</td>
              <!-- <td>{{task.ProjectName }}</td>
              <td>{{task.SegmentName }}</td>
              <td>{{task.AssignerName }}</td>
              <td>{{task.assign_time | date :'dd MMM yyyy hh:mm a '}}</td>
              <td>{{task.review_time | date :'dd MMM yyyy hh:mm a ' }}</td>
              <td><abbr title="Waiting for review  then click it"><i class="fas fa-check"
                    (click)="waitingForReview(task)"></i></abbr>
              </td> -->

            </tr>
          </tbody>
        </table>
      </div>



      <div *ngIf="activeTab=='Scheduled Task'">
        <table class="table table-border mt-1">
          <thead class="thead">
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Description</th>
              <!-- <th>Project</th>
              <th>Segment</th>
              <th>Assigner</th>
              <th>Start Time</th>
              <th>End Time</th>
              <th>Remark</th>
              <th>Action</th> -->

            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let task of scheduledTaskList; let i=index;">
              <td>0{{i+1}}</td>
              <td>{{task.Title }}</td>
              <td>{{task.Description }}</td>
              <!-- <td>{{task.ProjectName }}</td>
              <td>{{task.SegmentName}}</td>
              <td>{{task.AssignerName }}</td>
              <td>{{task.assign_time | date :'dd MMM yyyy hh:mm a '}}</td> -->
              <!-- <td><i class="far fa-edit" (click)="editTask(task)"></i><i class="fas fa-trash-alt" (click)="deleteTask(task)"></i>
                          </td> -->
              <!-- <td>{{task.review_time | date :'dd MMM yyyy hh:mm a ' }}</td>
              <td>{{task.review_remark}}</td>
              <td><abbr title="Check and Change then click it"><i class="fas  fa-check"
                    (click)="waitingForReview(task)"></i></abbr>
              </td> -->


            </tr>
          </tbody>
        </table>
      </div>

    </nb-card-body>

  </nb-card>