<nb-card>
  <nb-card-header>
    <div class="row">
      <div class="col-4">
        <h5 class="heading-design">Kanban Board <label *ngIf="dashboardState">({{project.projectName}})</label>
        </h5>
      </div>
      <div class="col-4">
        <div class="row" *ngIf="dashboardState">
          <div class="col-4">
            <input type='search' placeholder="Search" style="width: 100%;"
              (search)="getFilteredCard($event.target.value)">
          </div>
          <div class="col-4 verticalOverflow">
            <div class="userProfileIcons cursor-pointer" id="{{user.id}}" title="{{user.user_label}}"
              (click)="getCardsByUser(user.id)" [style.background]="user.color" *ngFor="let user of cardsUserGroup">
              {{user.name}}
            </div>
          </div>
          <div class="col-4">
            <button class="btn btn-primary ml-2" (click)="resetUserFilter()"
              *ngIf="filterUserGroup.length > 0">Clear</button>
          </div>
        </div>
      </div>


      <!--Start: For List Screen -->
      <!-- <div class="col-2" *ngIf="!dashboardState">
        <auto-suggestion (onSelected)="projectType = $event" display="name" [data]="typeList" placeholder="Select Type"
          seperator="-" [preSelected]="projectType.id >=0 ? {name:projectType.name} : {name:''}"
          className="borderStyle">
        </auto-suggestion>
      </div> -->
      <div class="col-4 text-right" *ngIf="!dashboardState">
        <!-- <button class="btn btn-primary mr-2" *ngIf="dashboardState"><i class="fa fa-filter"
            aria-hidden="true"></i>Filter</button> -->
        <button class="btn btn-primary" (click)="goToBoard({_id:null,project_desc:'All My Issues'},0)">My All
          Issues</button>
      </div>
      <!--Start: For List Screen -->


      <!--Start: For Board Screen -->
      <div class="col-2" *ngIf="dashboardState">
        <auto-suggestion (onSelected)="goToBoard($event,1)" display="project_desc" [data]="projectList"
          placeholder="Select Process" seperator="-" [preSelected]="{project_desc:project.projectName}"
          className="borderStyle" inputId="_id">
        </auto-suggestion>
      </div>
      <div class="col-2 text-right" *ngIf="dashboardState">
        <!-- <button class="btn btn-primary mr-2" *ngIf="dashboardState"><i class="fa fa-filter"
            aria-hidden="true"></i>Filter</button> -->

        <button class="btn btn-primary mr-2" id="taskpopup" title="Add Normal Task"
          (click)="showTaskPopup()"> Add Task
          <!-- <img src="./assets/images/addtask.svg" alt="Add Normal Task"> -->
        </button>

        <button class="btn btn-primary" (click)="goToList()">Back</button>
      </div>
      <!--Start: For Board Screen -->
    </div>
  </nb-card-header>

  <nb-card-body>

    <div class="row" *ngIf="!dashboardState">
      <div class="col-12">
        <smart-table *ngIf="projectList.length!=0" [data]="projectListTable.data" [settings]="projectListTable.settings"
          id="processList" class="sl-smart-table">
        </smart-table>
      </div>
    </div>



    <div class="row" style="padding: 1rem;" *ngIf="dashboardState">
      <!-- <div class="col-2">
        <button class="btn btn-primary" (click)="getTaskByType()">Other Issues</button>
      </div> -->
      <div class="col-6">
        <div class="row" style="min-height: 110px;">
          <div class="col-4 font-weight-bold my-auto" style="vertical-align: center;">Currently Working</div>
          <div class="col-8 cardContainerProgress" *ngFor="let state of taskStatusBarData;let i = index" cdkDropList
            [cdkDropListData]="state.data" (cdkDropListDropped)="drop($event);" [id]="state.id">
            <div class="row inprocessCardStyle" *ngFor="let data of state.data" cdkDrag>
              <div class="col-12 text-left title">
                <h5 [style.color]="data.type_color" title="{{data.title + '\n' + data._task_desc}}"class="mb-0 cardTitleStyle">{{data.title}}</h5>
              </div>
              <!-- <div class="col-12 text-left">
                <label class="cardTitleStyle font-weight-bold cursor-pointer" title="{{data._project_type}}" >{{data._project_type}}</label>
              </div> -->
            </div>
            <div class="row align-items-center" *ngIf="taskStatusBarData[0].data[0]">
              <div class="col-4 pr-0">
                <button *ngIf="state.data[0]['log_start_time']" class="btn btn-primary timer-btn" (click)="saveActivityLog(state.data[0], 1,state.data[0]['log_start_time'],common.getDate())">Pause</button>
                <button *ngIf="!state.data[0]['log_start_time']" class="btn btn-primary timer-btn" (click)="saveActivityLog(state.data[0], 0,common.getDate(),null)">Start</button>
              </div>
              <div class="col-4 pr-0 pl-0 small" id="timer"><i class="far fa-clock"></i>  {{inprogressTimer}}</div>
              <div class="col-4 pl-0 text-right"><button class="btn btn-primary timer-btn" (click)="saveActivityLog(state.data[0], 0,state.data[0]['log_start_time'],common.getDate())">Done</button></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-6 text-right my-auto" *ngIf="project.projectId">
        <!-- <button class="btn btn-primary" (click)="issueSort(0)" *ngIf="issueCategory">My Issues</button>
        <button class="btn btn-primary" (click)="issueSort(1)" *ngIf="!issueCategory">All Issues</button> -->
        <button class="btn btn-primary" (click)="goToBoard({_id:null,project_desc:'All My Issues'},0)">My All
          Issues</button>
      </div>

      <div class="col-6 text-right my-auto" *ngIf="!project.projectId">
        <button class="btn customBtn-primary" [class.buttonActive]= "activeButton === 'to'" (click)="activeButton = 'to';getDashboardByType(0)">To</button>
        <button class="btn customBtn-primary" [class.buttonActive]= "activeButton === 'by'" (click)="activeButton = 'by';getDashboardByType(2)">By</button>
        <button class="btn customBtn-primary" [class.buttonActive]= "activeButton === 'cc'" (click)="activeButton = 'cc';getDashboardByType(3)">CC</button>
      </div>
    </div>

    <div class="row stateContainer" id="cardField" *ngIf="dashboardState">
      <div class="stateContainerStyle col" [style.width.%]="100/cardlength"  *ngFor="let card of cards;let i = index">
        <div class="stateStatusBar" [style.background]="card.color"></div>
        <!-- background: {{data.color}};-->
        <div class="title">
          <div class="strip" [style.background]="card.color">    
          </div>
          <h5 class="stateTitleStyle" title="{{card.title}}">{{card.title}}</h5>
        </div>
        <div class="stateTansActCountStyle">
          <label>{{card.normalTaskCount}} Normal / {{card.scheduleTaskCount}} Schedule</label>
        </div>

        <div class="cardStyle" cdkDropList [cdkDropListData]="card.data" (cdkDropListDropped)="drop($event);"
          [id]="card.title" [cdkDropListConnectedTo]="card.connectedto">

          <div class="row shadow-sm"
            [ngClass]="data.type.includes('Normal') ? 'NormalStyle' : 'ScheduledStyle'" *ngFor="let data of card.data"
            cdkDrag (cdkDragStarted)="onDragStarted($event)" (cdkDragEnded)="onDragEnded($event)"
            (cdkDragMoved)="movedIn($event)" (click)="ticketMessage(data,null)"
            [cdkDragDisabled]="project.projectId && data.userid != loggedInUser">
            <div class="col-12">
              <h5 [style.color]="data.type_color" title="{{'Subject: ' + data.title + '\n' + 'Description: ' +data._task_desc}}"class="mb-0 cardTitleStyle">{{data.title}}</h5>
            </div>
            <div class="col-12"><label class="cardTitleStyle font-weight-bold cursor-pointer" title="{{data._project_type}}" (click)="[101,102].includes(data._tktype) ? openUpdateTaskProject($event,data) : null">{{data._project_type}}</label></div>
            <div class="col-12"><label class="cardTitleStyle">{{data.due_date}}</label></div>
            <!-- <div class="col-12">
              <label class="cardTitleStyle" title="{{data._task_desc}}">{{data._task_desc}}</label>
            </div> -->
            <div class="col-12 pb-2">
              <div class="row">
                <div class="col-6">
                  <i class="fas fa-arrow-up text-danger"  title="High Priority" *ngIf="data.priority"></i>
                  <i class="fas fa-arrow-up text-warning" title="Low Priority" *ngIf="!data.priority"></i>
                  <i class="fa fa-comments text-danger pl-1" aria-hidden="true" title="Reply Demanded" *ngIf="data._reply_demanded > 0"></i>
                  <div>{{data.status}}</div>
                </div>
                <div class="col-6">
                  <div class="rounded-circle" [style.background]="project.projectId ? '#008000' : '#3366ff'"
                    title="{{data.user_label}}">
                    {{data.user}}</div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </nb-card-body>

<!-- 
  <div class="modal" id="otherTaskModal" #otherTaskModal>
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Other Tasks</h5>
          <button type="button" class="close" data-dismiss="modal" (click)="closeotherTaskModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div style="height: 180px;overflow: auto;">
            <div class="row otherTaskListStyle cursor-pointer" *ngFor="let other of completeOtherTask;let i = index"
              (click)="insertFromOtherToProgress(other,i)"
              [ngClass]="{'focusOtherTaskList' : otherTaskActiveTab === i}">
              <div class="col-6" style="white-space: nowrap;">
                {{other.task_subject}}
              </div>
              <div class="col-6 text-right">
                {{other.assignedAs}}
              </div>
            </div>
          </div>

          <div>
            <div class="row m-2" style="float: right;">
              <button class="btn btn-primary" (click)="assignTaskToProgress()">In Progress</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> -->

</nb-card>