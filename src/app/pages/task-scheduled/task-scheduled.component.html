<nb-card>
    <nb-card-header>
        <div class="row">
            <div class="col-10">
                <h5>Scheduled Task</h5>
            </div>
        </div>
    </nb-card-header>
    <nb-card>
        <nb-card-body>
            <div>
                <div class="container">
                    <div class="row ">
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Department<span class="text-danger">*</span></label>
                                <auto-suggestion (onSelected)="scheduledTask.department = $event" [data]="departmentList" display="name" seperator="-" placeholder="Select Department" autocomplete="off" name="departmentId" inputId="departmentId" [preSelected]="scheduledTask.department.id ? {name: scheduledTask.department.name}:{name:''}">
                                </auto-suggestion>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Description<span class="text-danger">*</span></label>
                                <!-- <input style="width: 100%;" type="description" placeholder="Description" class="form-control" [(ngModel)]="scheduledTask.description"> -->
                                <textarea row="2" cols="15" placeholder="Enter Description" name="description" class="form-control" [(ngModel)]="scheduledTask.description"></textarea>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Primary User<span class="text-danger">*</span></label>
                                <auto-suggestion (onSelected)="scheduledTask.primaryUser = $event" [data]="adminList" display="name" seperator="-" placeholder="Primary User" autocomplete="off" name="primaryUser" inputId="primaryUserId" [preSelected]="scheduledTask.primaryUser.id ? {name: scheduledTask.primaryUser.name}:{name:''}">
                                </auto-suggestion>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Escalation User<span class="text-danger">*</span></label>
                                <auto-suggestion (onSelected)="scheduledTask.escalationUser = $event" [data]="adminList" display="name" seperator="-" placeholder="Escalation User" autocomplete="off" name="escalationUser" inputId="scalationUserId" [preSelected]="scheduledTask.escalationUser.id ? {name: scheduledTask.escalationUser.name}:{name:''}">
                                </auto-suggestion>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Reporting User<span class="text-danger">*</span></label>
                                <auto-suggestion (onSelected)="scheduledTask.reportingUser = $event" [data]="adminList" display="name" seperator="-" placeholder="Reporting User" autocomplete="off" name="reportingUser" inputId="reportingUserId" [preSelected]="scheduledTask.reportingUser.id ? {name: scheduledTask.reportingUser.name}:{name:''}">
                                </auto-suggestion>
                            </div>
                        </div>
                        <!-- <div class="col-sm-4">
                            <div class="form-group">
                                <label>Logic Type<span class="text-danger">*</span></label>
                                <select class="form-controlr" class="form-control" [(ngModel)]="scheduledTask.logicType" (change)="onChangeLogicType()">
                                    <option value=1>Daily</option>
                                    <option value=2>Weekly</option>
                                    <option value=3>Monthly</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Schedule Param<span class="text-danger">*</span></label>
                                <select *ngIf="scheduledTask.logicType==1 || scheduledTask.logicType=='' " class="form-controlr" class="form-control" [(ngModel)]="scheduledTask.scheduleParam">
                                  <option *ngFor= "let dd of dailyParam" [value]="dd.id">{{dd.name}}</option>
                                </select>
                                <select *ngIf="scheduledTask.logicType==2" class="form-controlr" class="form-control" [(ngModel)]="scheduledTask.scheduleParam">
                                  <option *ngFor= "let dd of weeklyParam" [value]="dd.id">{{dd.name}}</option>
                                </select>
                                <select *ngIf="scheduledTask.logicType==3" class="form-controlr" class="form-control" [(ngModel)]="scheduledTask.scheduleParam">
                                  <option *ngFor= "let dd of monthlyParam" [value]="dd.id">{{dd.name}}</option>
                                </select>
                            </div>
                        </div> -->
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Days<span class="text-danger">*</span></label>
                                <input style="width: 100%;" type="number" maxlength="2" placeholder="Days" class="form-control" [(ngModel)]="scheduledTask.days">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Hours<span class="text-danger">*</span></label>
                                <input style="width: 100%;" type="number" placeholder="Hours" class="form-control" [(ngModel)]="scheduledTask.hours">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label class="mr-1">Is Active</label>
                                <input type="checkbox" [checked]="scheduledTask.isActive" (change)="scheduledTask.isActive = !scheduledTask.isActive" />
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>CC users:</label>
                                <auto-suggestion [data]="adminList" display="name" seperator="-" placeholder="Select CC Users" [preSelected]="scheduledTask.ccUsers" (onSelected)="scheduledTask.ccUsers = $event" inputId="ccUsers" name="ccUsers" isMultiSelect="true" autocomplete="off"></auto-suggestion>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 text-right">
                            <button class="btn btn-primary text-capitalize mr-2" id="button" (click)="resetScheduleTask()">Reset</button>
                            <button class="btn btn-primary text-capitalize" id="button" (click)="saveScheduleTask()">Save</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Tabs      -->
            <div class="tabs_style_main">
                <ul class="tabs_style text-left">
                    <li [ngClass]="activeTab=='ScheduledTaskMaster'?'active':''" (click)="activeTab='ScheduledTaskMaster'; getScheduledTask()">
                        Scheduled Task Master
                    </li>
                    <li [ngClass]="activeTab=='normalTask'?'active':''" (click)="activeTab='normalTask';activeTabNormal='';resetSearchTask()">
                        Normal Task
                    </li>
                    <li [ngClass]="activeTab=='scheduledTask'?'active':''" (click)="activeTab='scheduledTask';activeTabScheduled=''; resetSearchTask()">
                        Scheduled Task
                    </li>
                    <li [ngClass]="activeTab=='userReport'?'active':''" (click)="activeTab='userReport';getUserReport(null)">
                        Task Report
                    </li>
                    <li [ngClass]="activeTab=='scheduledUserReport'?'active':''" (click)="activeTab='scheduledUserReport';getUserReport(1)">
                        Scheduled Task Report
                    </li>
                </ul>
            </div>
            <!-- start:normal task subtab -->
            <div *ngIf="activeTab=='normalTask'">
                <ul class="tabs_style text-left">
                    <li [ngClass]="activeTabNormal=='pending'?'active':''" (click)="activeTabNormal='pending'; getAllTask(-3)">
                        Pending Task
                    </li>
                    <li [ngClass]="activeTabNormal=='ack'?'active':''" (click)="activeTabNormal='ack'; getAllTask(-33)">
                        Ack Task
                    </li>
                    <li [ngClass]="activeTabNormal=='completed'?'active':''" (click)="activeTabNormal='completed'; getAllTask(-1)">
                        Completed Task
                    </li>
                </ul>

                <div *ngIf="activeTabNormal=='pending'">
                    <smart-table *ngIf="unacknowledgedNormalTaskList.length!=0" [data]="tableUnacknowledgedNormalTask.data" [settings]="tableUnacknowledgedNormalTask.settings" id="unacknowledgedNormalTaskList">
                    </smart-table>
                </div>
                <div *ngIf="activeTabNormal=='ack'">
                    <smart-table *ngIf="ackNormalTaskList.length!=0" [data]="tableAckNormalTask.data" [settings]="tableAckNormalTask.settings" id="ackNormalTaskList">
                    </smart-table>
                </div>
                <div *ngIf="activeTabNormal=='completed'">
                    <div class="row" style="z-index: 999;">
                        <div class="col-4">
                            <uj-date-time-picker [isStart]="true" [isTime]="false" (onChanged)="searchTask.startDate=$event" [dateTimeValue]="searchTask.startDate">
                            </uj-date-time-picker>
                        </div>
                        <div class="col-4">
                            <uj-date-time-picker [isStart]="true" [isTime]="false" (onChanged)="searchTask.endDate=$event" [dateTimeValue]="searchTask.endDate">
                            </uj-date-time-picker>
                        </div>
                        <div class="col-4">
                            <button class="btn btn-primary text-capitalize" id="button" (click)="searchAllCompletedTask('normal')">Search</button>
                        </div>
                    </div>
                    <smart-table *ngIf="allTaskList.length!=0" [data]="tableAllTask.data" [settings]="tableAllTask.settings" id="allTaskList">
                    </smart-table>
                </div>
            </div>
            <!-- end:normal task subtab -->
            <!-- start:scheduled task subtab -->
            <div *ngIf="activeTab=='scheduledTask'">
                <ul class="tabs_style text-left">
                    <li [ngClass]="activeTabScheduled=='pending'?'active':''" (click)="activeTabScheduled='pending'; getAllTask(-4)">
                        Pending Task
                    </li>
                    <li [ngClass]="activeTabScheduled=='ack'?'active':''" (click)="activeTabScheduled='ack'; getAllTask(-44)">
                        Ack Task
                    </li>
                    <li [ngClass]="activeTabScheduled=='completed'?'active':''" (click)="activeTabScheduled='completed'; getAllTask(-2)">
                        Completed Task
                    </li>
                </ul>

                <div *ngIf="activeTabScheduled=='pending'">
                    <smart-table *ngIf="unacknowledgedScheduledTaskList.length!=0" [data]="tableUnacknowledgedScheduledTask.data" [settings]="tableUnacknowledgedScheduledTask.settings" id="unacknowledgedScheduledTaskList">
                    </smart-table>
                </div>
                <div *ngIf="activeTabScheduled=='ack'">
                    <smart-table *ngIf="ackScheduleTaskList.length!=0" [data]="tableAckScheduleTask.data" [settings]="tableAckScheduleTask.settings" id="ackScheduleTaskList">
                    </smart-table>
                </div>
                <div *ngIf="activeTabScheduled=='completed'">
                    <div class="row" style="z-index: 999;">
                        <div class="col-4">
                            <uj-date-time-picker [isStart]="true" [isTime]="false" (onChanged)="searchTask.startDate=$event" [dateTimeValue]="searchTask.startDate">
                            </uj-date-time-picker>
                        </div>
                        <div class="col-4">
                            <uj-date-time-picker [isStart]="true" [isTime]="false" (onChanged)="searchTask.endDate=$event" [dateTimeValue]="searchTask.endDate">
                            </uj-date-time-picker>
                        </div>
                        <div class="col-4">
                            <button class="btn btn-primary text-capitalize" id="button" (click)="searchAllCompletedTask('scheduled')">Search</button>
                        </div>
                    </div>
                    <smart-table *ngIf="allScheduleTaskList.length!=0" [data]="tableAllScheduleTask.data" [settings]="tableAllScheduleTask.settings" id="allScheduleTaskList">
                    </smart-table>
                </div>
            </div>
            <!-- end:scheduled task subtab -->

            <div *ngIf="activeTab=='ScheduledTaskMaster'">
                <smart-table *ngIf="scheduledTaskList.length!=0" [data]="tableSchedule.data" [settings]="tableSchedule.settings" id="scheduledTaskList">
                </smart-table>
            </div>
            <div *ngIf="activeTab=='userReport'">
                <smart-table *ngIf="userReportList.length!=0" [data]="tableUserReportList.data" [settings]="tableUserReportList.settings" id="userReportList">
                </smart-table>
            </div>
            <div *ngIf="activeTab=='scheduledUserReport'">
                <smart-table *ngIf="scheduledUserReportList.length!=0" [data]="tableScheduledUserReportList.data" [settings]="tableScheduledUserReportList.settings" id="tableScheduledUserReportList">
                </smart-table>
            </div>
        </nb-card-body>
    </nb-card>